<IfModule security2_module>
    # 1. Activar motor de reglas en modo BLOQUEO
    SecRuleEngine On

    # 2. Límites de tamaño (Anti-DoS y Desbordamiento)
    # 12.5 MB máximo para el cuerpo de la petición
    SecRequestBodyLimit 13107200
    SecRequestBodyNoFilesLimit 131072
    
    # 128 KB para procesamiento en RAM
    SecRequestBodyInMemoryLimit 131072
    
    # 512 KB máximo para la respuesta
    SecResponseBodyLimit 524288

    # 3. Regla Manual para Validación (Simulación de Path Traversal)
    # Sin las reglas OWASP CRS, ModSecurity base no detecta '/etc/passwd' por defecto.
    # Añadimos esta regla para que la prueba del ejercicio funcione:
    SecRule ARGS "etc/passwd" "id:1001,deny,status:403,msg:'Intento de acceso a archivo sensible'"
</IfModule>
